{% extends "templates/web.html" %}

{% block header %}
<h1 style="margin-top: 10px; font-size: 24px;">{{ doc.name }}</h1>
{% endblock %}

{% block script %}
<script>{% include "templates/includes/rfq.js" %}</script>
{% endblock %}

{% block breadcrumbs %}
	{% include "templates/includes/breadcrumbs.html" %}
{% endblock %}

{% block header_actions %}
{% if doc.items %}
    <button class="btn btn-primary btn-sm" type="button">
        {{ _("Make Quotation") }}
    </button>
    <button class="btn btn-secondary add-supplier-attachment" type="button">
            {{ _("Add Attachment") }}
    </button>
    <button class="btn btn-secondary download-rfq" type="button" title="Download">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
        </svg>
    </button>

{% endif %}
{% endblock %}

{% block page_content %}
<div class="row">
    <div class="col-6">
        <div class="rfq-supplier"><strong>Supplier:</strong> {{ doc.supplier or "-" }}</div>
	</div>
    <div class="col-6 text-muted text-right h6">
        <strong>Transaction Date:</strong> {{ doc.get_formatted("transaction_date") or "-" }}
    </div>
</div>

<!-- âœ… Required Date -->
<div class="row mt-3">
    <div class="col-6">
        <strong>Required Date:</strong>
        {% if doc.items %}
            {% for item in doc.items %}
                <div>{{ item.item_name or "-" }} : {{ item.schedule_date or "-" }}</div>
            {% endfor %}
        {% else %}
            <div>-</div>
        {% endif %}
    </div>
</div>


<div class="rfq-content" style="margin-top:15px">
	<div id="order-container">
		<div id="rfq-items">
			<div class="row cart-item-header">
                <div class="col-sm-3 col-12">{{ _("Items") }}</div>
                <div class="col-sm-2 col-4 text-right">{{ _("Tag No") }}</div>
                <div class="col-sm-1 col-4 text-right">{{ _("Qty") }}</div>
                <div class="col-sm-2 col-4 text-right">{{ _("Rate") }}</div>
                
                <div class="col-sm-2 col-4 text-right">{{ _("Model") }}</div>
                <div class="col-sm-1 col-4 text-right">{{ _("Amount") }}</div>
            </div>

			<hr>
            {% if doc.items %}
            <div class="rfq-items">
				{% include "templates/includes/rfq/rfq_items.html" %}
            </div>
            {% endif %}
		</div>
        {% if doc.items %}
		<div class="row grand-total-row">
			<div class="col-9 text-right">{{ _("Grand Total") }}</div>
			<div class="col-3 text-right">
				{{ doc.currency_symbol or "" }} <span class="tax-grand-total">0.0</span>
			</div>
		</div>
        {% endif %}
        

        {% if doc.custom_addendum %}
        <hr>
        <div class="row mt-3">
            <div class="col-12">
                <h5><strong>{{ _("RFQ Documents") }}</strong></h5>
                <table class="table table-bordered mt-2">
                    <thead>
                        <tr>
                            <th>{{ _("Attachment Type") }}</th>
                            <th>{{ _("File") }}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for file in doc.custom_addendum %}
                        <tr>
                            <td>{{ file.attachment_type or "-" }}</td>
                            <td>
                                {% if file.attachment %}
                                    <a href="{{ file.attachment }}" target="_blank" class="btn btn-link p-0">
                                        <i class="fa fa-paperclip"></i> {{ _("View") }}
                                    </a>
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
        <hr>

        <!-- ðŸ“Ž Supplier Attachments Section -->
       
        <div class="row mt-4" id="supplier-attachments-section" style="display:none;">
            <div class="col-12">
                <h5><strong>{{ _("Supplier Attachments") }}</strong></h5>
                <p class="text-muted small mb-2">{{ _("Upload your quotation-related files here") }}</p>
                <table class="table table-bordered" id="supplier-attachments-table">
                    <thead>
                        <tr>
                            <th>{{ _("Attachment Type") }}</th>
                            <th>{{ _("File") }}</th>
                            <th>{{ _("Remark") }}</th>
                            <th>{{ _("Action") }}</th>
                        </tr>
                    </thead>
                    <tbody id="supplier-attachments-body">
                    </tbody>
                </table>
                
            </div>
        </div>
        <hr>


		<div class="row terms" style="margin-top: -40px;">
			<div class="col-6">
				<br><br>
				<p><strong>{{ _("Notes: ") }}</strong></p>
				<textarea class="form-control terms-feedback" style="height: 100px;"></textarea>
			</div>
		</div>
        <hr>
		     
    </div>
</div>

<!-- ðŸ“Ž Attachment Modal -->
<div class="modal fade" id="attachmentModal" tabindex="-1" aria-labelledby="attachmentModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content rounded-lg shadow">
      <div class="modal-header">
        <h5 class="modal-title" id="attachmentModalLabel">Add Attachment</h5>
        <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="form-group mb-3">
          <label for="attachmentType">Attachment Type</label>
          <select id="attachmentType" class="form-control">
            <option value="">Select Type</option>
            <option value="Technical">Technical</option>
            <option value="Commercial">Commercial</option>
            <option value="Terms and Conditions">Terms and Conditions</option>
            <option value="Unpriced">Unpriced</option>
          </select>
        </div>
        <div class="form-group mb-3">
          <label for="attachmentFile">File</label>
          <input type="file" id="attachmentFile" class="form-control">
        </div>
        <div class="form-group mb-3">
          <label for="attachmentRemark">Remark</label>
          <input type="text" id="attachmentRemark" class="form-control" style="height: auto;" placeholder="Remark">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-secondary" id="saveAttachment">Save</button>
      </div>
    </div>
  </div>
</div>

{% endblock %}
